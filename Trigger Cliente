
DELIMITER //
CREATE TRIGGER dispUsuCli BEFORE INSERT ON Cliente
FOR EACH ROW
BEGIN
    DECLARE cont int;
    DECLARE idUC int;
    DECLARE contrase単a varchar(32);
    DECLARE correo varchar(35);


    SET idUC = (SELECT MAX(idUsu) FROM Usuario);
    IF idUC is NULL THEN
    SET idUC = 1;
    ELSE 
    SET idUC = idUC +1;
    END IF;

    SET contrase単a = (md5(new.passCli));

    SET correo =new.correoCli;

    SET cont= (SELECT COUNT(*) 
              FROM Usuario
              WHERE Usuario.CorreoUs like correo);

    
    IF cont like 0 THEN
    INSERT INTO Usuario VALUES(idUC, contrase単a, correo);
    SET new.passCli=contrase単a;
    SET new.Usuario=idUC;
    ELSE
    SET new.idCli=null;
   END IF;

END//
DELIMITER ;
